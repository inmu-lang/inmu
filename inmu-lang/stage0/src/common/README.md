# INMU Stage 0 共通ロジック

このディレクトリは、ARM64とx86_64の両アーキテクチャで共有されるロジックのドキュメントを含みます。

## ディレクトリ構成

```
common/
├── README.md           # このファイル
├── algorithm.md        # アルゴリズム全体の説明
├── parser.md          # パーサーロジック
├── expression.md      # 式評価ロジック
├── variables.md       # 変数管理ロジック
├── control.md         # 制御構造ロジック
└── constants.md       # 共通定数定義
```

## 実装アーキテクチャ

各アーキテクチャは `src/arch/{ARCH}/` に配置されます：

- `src/arch/arm64/` - Apple Silicon (ARM64) 実装
- `src/arch/x86_64/` - Intel Mac (x86_64) 実装

## 共通化戦略

1. **ロジックの共通化**: アルゴリズムとデータ構造をMarkdownで文書化
2. **アーキテクチャ固有実装**: レジスタ、命令セットはアーキテクチャ別
3. **インターフェース統一**: 関数呼び出し規約とデータレイアウトを統一

## 各モジュールの責務

### パーサー (parser.md)
- ファイルの読み込みと解析
- トークンの認識
- キーワード検出

### 式評価 (expression.md)
- 算術演算子の評価
- 演算子優先順位の処理
- 括弧のサポート

### 変数管理 (variables.md)
- 変数の保存と取得
- 変数テーブルの管理

### 制御構造 (control.md)
- if/else/endif の処理
- 条件評価
- ブロックのスキップ
